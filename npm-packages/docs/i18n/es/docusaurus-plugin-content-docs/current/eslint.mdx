---
title: Reglas de ESLint
sidebar_position: 30
description: Reglas de ESLint para Convex
---

El plugin de ESLint de Convex proporciona reglas de linter que aplican las mejores pr√°cticas para las funciones de Convex. ¬°H√°znos saber si hay alguna regla que te ser√≠a √∫til!

## Configuraci√≥n \{#setup\}

Para ESLint 9 (configuraci√≥n plana, usando `eslint.config.js`), instala las reglas con:

```bash
npm i @convex-dev/eslint-plugin --save-dev
```

y a√±ade lo siguiente a tu archivo `eslint.config.js`:

```ts
import { defineConfig } from "eslint/config";

import convexPlugin from "@convex-dev/eslint-plugin";

export default defineConfig([
  // Otras configuraciones

  ...convexPlugin.configs.recommended,
]);
```

<Details summary={<>Si est√°s usando el formato obsoleto <code>.eslintrc.js</code></>}>
  Instala estos dos plugins:

  ```bash
  npm i @typescript-eslint/eslint-plugin @convex-dev/eslint-plugin --save-dev
  ```

  En `.eslintrc.js`, agrega:

  ```js
  module.exports =
    extends: [
      // Other configurations
      "plugin:@typescript-eslint/recommended",
      "plugin:@convex-dev/recommended",
    ],
    ignorePatterns: ["node_modules/", "dist/", "build/"],
  };
  ```
</Details>

<Details summary={<>Si tus funciones de Convex est√°n en un directorio distinto de <code>convex</code></>}>
  De forma predeterminada, el plugin de ESLint de Convex solo aplicar√° reglas en el directorio `convex`.

  Si est√°s
  [personalizando la ubicaci√≥n del directorio de Convex](/production/project-configuration#changing-the-convex-folder-name-or-location),
  aqu√≠ te mostramos c√≥mo adaptar tu configuraci√≥n de ESLint:

  ```ts
  // eslint.config.js
  import { defineConfig } from "eslint/config";

  import convexPlugin from "@convex-dev/eslint-plugin";

  const recommendedConfig = convexPlugin.configs.recommended[0];
  const recommendedRules = recommendedConfig.rules;

  export default defineConfig([
    // Other configurations go here...

    // Custom configuration with modified directory pattern
    {
      files: ["**/src/convex/**/*.ts"],
      plugins: {
        "@convex-dev": convexPlugin,
      },
      rules: recommendedRules,
    },
  ]);
  ```
</Details>

<Details summary={<>Si est√°s usando el comando <code>next lint</code> de Next.js</>}>
  Para que `next lint` ejecute ESLint en tu directorio `convex`, debes agregar ese
  directorio al conjunto predeterminado de directorios. Agrega esta secci√≥n a tu
  `next.config.ts`:

  ```ts
  const nextConfig: NextConfig = {
    /* other options here */

    eslint: {
      dirs: ["pages", "app", "components", "lib", "src", "convex"],
    },
  };
  ```
</Details>

## Reglas \{#rules\}

| Regla                                                                                                                                   | Recomendado | Autocorregible |
| --------------------------------------------------------------------------------------------------------------------------------------- | :---------: | :------------: |
| [`@convex-dev/no-old-registered-function-syntax`](#no-old-registered-function-syntax)<br />Preferir la sintaxis de objeto para las funciones registradas |     ‚úÖ      |       üîß       |
| [`@convex-dev/require-argument-validators`](#require-argument-validators)<br />Requerir validadores de argumentos para las funciones de Convex |     ‚úÖ      |       üîß       |
| [`@convex-dev/explicit-table-ids`](#explicit-table-ids)<br />Requerir nombres de tabla expl√≠citos en las operaciones de base de datos    |     ‚úÖ      |       üîß       |
| [`@convex-dev/import-wrong-runtime`](#import-wrong-runtime)<br />Evitar que los archivos de runtime de Convex importen desde archivos de runtime de Node |             |                |

### no-old-registered-function-syntax \{#no-old-registered-function-syntax\}

Usa la sintaxis de objeto para las funciones registradas.

Las consultas, mutaciones y acciones de Convex se pueden definir con una √∫nica funci√≥n o
con un objeto que contenga una propiedad handler. Usar objetos hace
posible agregar validadores de argumentos y de valores de retorno, por lo que siempre es preferible.

```ts
// ‚úÖ Allowed by this rule:
export const list = query({
  handler: async (ctx) => {
    const data = await ctx.db.query("messages").collect();
    ...
  },
});

// ‚ùå No permitido por esta regla:
export const list = query(async (ctx) => {
  const data = await ctx.db.query("messages").collect();
  ...
});
```

### require-argument-validators \{#require-argument-validators\}

Exigir validadores de argumentos para las funciones de Convex.

Las consultas, mutaciones y acciones de Convex pueden validar sus argumentos antes
de comenzar a ejecutar la funci√≥n manejadora. Adem√°s de ser una forma concisa de validar
los tipos de argumentos, el uso de validadores de argumentos permite generar especificaciones
de funciones m√°s descriptivas y, por lo tanto, bindings de OpenAPI.

```ts
// ‚úÖ Allowed by this rule:
export const list = query({
  args: {},
  handler: async (ctx) => {
    ...
  },
});

// ‚úÖ Allowed by this rule:
export const list = query({
  args: { channel: v.id('channel') },
  handler: async (ctx, { channel }) => {
    ...
  },
});

// ‚ùå No permitido con la opci√≥n { ignoreUnusedArguments: false } (predeterminada)
// ‚úÖ Permitido con la opci√≥n { ignoreUnusedArguments: true }
export const list = query({
  handler: async (ctx) => {
    ...
  },
});

// ‚ùå Not allowed by this rule:
export const list = query({
  handler: async (ctx, { channel }: { channel: Id<"channel"> }) => {
    ...
  },
});
```

Esta regla se puede personalizar para tolerar funciones que no definen un validador de argumentos y que tampoco usan sus argumentos. As√≠ puedes configurar la regla para que funcione de esta forma:

```ts
// eslint.config.js

export default defineConfig([
  // Tus otras reglas...

  {
    files: ["**/convex/**/*.ts"],
    rules: {
      "@convex-dev/require-args-validator": [
        "error",
        {
          ignoreUnusedArguments: true,
        },
      ],
    },
  },
]);
```

### explicit-table-ids \{#explicit-table-ids\}

Exige nombres de tablas expl√≠citos en las operaciones de base de datos.

A partir de la versi√≥n 1.31.0 del paquete `convex` de npm, recomendamos incluir
el nombre de la tabla como primer argumento en las operaciones de base de datos (`db.get`,
`db.replace`, `db.patch`, `db.delete`).

Este enfoque es m√°s seguro porque evita vulnerabilidades cuando un Id de
una tabla se tipa incorrectamente como perteneciente a otra tabla. La sintaxis
impl√≠cita (donde los nombres de las tablas se infieren a partir del Id) quedar√° obsoleta en el
futuro para dar a los desarrolladores un mayor control sobre la generaci√≥n de Id. Por ambas
razones, recomendamos que los desarrolladores migren al nuevo formato.

Esta regla ayuda a migrar c√≥digo del antiguo formato impl√≠cito al nuevo formato
expl√≠cito. Utiliza la informaci√≥n de tipos de TypeScript para inferir autom√°ticamente el nombre
de la tabla a partir del tipo `Id<"tableName">` y proporciona correcciones autom√°ticas.

```ts
const messageId: Id<"messages"> = "123" as Id<"messages">;

// ‚úÖ Allowed by this rule:
const message = await ctx.db.get("messages", messageId);
await ctx.db.patch("messages", messageId, { text: "updated" });
await ctx.db.replace("messages", messageId, {
  text: "replaced",
  author: "Alice",
});
await ctx.db.delete("messages", messageId);

// ‚ùå No permitido por esta regla:
const message = await ctx.db.get(messageId);
await ctx.db.patch(messageId, { text: "updated" });
await ctx.db.replace(messageId, { text: "replaced", author: "Alice" });
await ctx.db.delete(messageId);
```

<Admonition type="info" title="Se requiere typescript-eslint">
  Para que esta regla funcione,
  [typescript-eslint](https://typescript-eslint.io) debe estar configurado en la
  configuraci√≥n de ESLint. Si typescript-eslint est√° instalado y la regla no
  parece funcionar, aseg√∫rate de que el
  [linting con conocimiento de tipos](https://typescript-eslint.io/troubleshooting/typed-linting/)
  est√© habilitado.
</Admonition>

Ten en cuenta que, si no est√°s usando ESLint, tambi√©n puedes usar la
herramienta de CLI `@convex-dev/codemod` para migrar autom√°ticamente al nuevo formato:

```bash
npx @convex-dev/codemod@latest explicit-ids
```

[M√°s informaci√≥n en news.convex.dev ‚Üí](https://news.convex.dev/db-table-name/)

### import-wrong-runtime \{#import-wrong-runtime\}

Impide que los archivos de runtime de Convex importen desde archivos de runtime de Node (archivos con la directiva `"use node"`).

Esta regla es experimental. Haznos saber si te resulta √∫til.

```ts
// En un archivo que no usa `"use node"`:

// ‚úÖ Permitido por esta regla:
import { someFunction } from "./someOtherFile"; // donde someOtherFile no usa `"use node"`

// ‚ùå No permitido por esta regla:
import { someFunction } from "./someNodeFile"; // donde someNodeFile usa `"use node"`
```
