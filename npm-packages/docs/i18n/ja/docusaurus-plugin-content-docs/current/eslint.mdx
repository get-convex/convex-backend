---
title: ESLint ãƒ«ãƒ¼ãƒ«
sidebar_position: 30
description: Convex ç”¨ã® ESLint ãƒ«ãƒ¼ãƒ«
---

Convex ESLint ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ã€Convex é–¢æ•°ãŒãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã«æº–æ‹ ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã® Lint ãƒ«ãƒ¼ãƒ«ã‚’æä¾›ã—ã¾ã™ã€‚å½¹ã«ç«‹ã¡ãã†ãªãƒ«ãƒ¼ãƒ«ãŒã‚ã‚Œã°ã€ãœã²æ•™ãˆã¦ãã ã•ã„ã€‚

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— \{#setup\}

ESLint 9ï¼ˆ`eslint.config.js` ã‚’ä½¿ã†ãƒ•ãƒ©ãƒƒãƒˆæ§‹æˆï¼‰ã®ãƒ«ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã«ã¯ã€æ¬¡ã‚’å®Ÿè¡Œã—ã¾ã™:

```bash
npm i @convex-dev/eslint-plugin --save-dev
```

æ¬¡ã®å†…å®¹ã‚’ `eslint.config.js` ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ ã—ã¦ãã ã•ã„ï¼š

```ts
import { defineConfig } from "eslint/config";

import convexPlugin from "@convex-dev/eslint-plugin";

export default defineConfig([
  // ãã®ä»–ã®è¨­å®š

  ...convexPlugin.configs.recommended,
]);
```

<Details summary={<>éæ¨å¥¨ã® <code>.eslintrc.js</code> ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆ</>}>
  æ¬¡ã® 2 ã¤ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„:

  ```bash
  npm i @typescript-eslint/eslint-plugin @convex-dev/eslint-plugin --save-dev
  ```

  `.eslintrc.js` ã«æ¬¡ã‚’è¿½åŠ ã—ã¾ã™:

  ```js
  module.exports =
    extends: [
      // ä»–ã®è¨­å®š
      "plugin:@typescript-eslint/recommended",
      "plugin:@convex-dev/recommended",
    ],
    ignorePatterns: ["node_modules/", "dist/", "build/"],
  };
  ```
</Details>

<Details summary={<>Convex é–¢æ•°ã‚’ <code>convex</code> ä»¥å¤–ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®ã—ã¦ã„ã‚‹å ´åˆ</>}>
  ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€Convex ESLint ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ `convex`
  ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã«ã®ã¿ãƒ«ãƒ¼ãƒ«ã‚’é©ç”¨ã—ã¾ã™ã€‚

  Convex ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å ´æ‰€ã‚’
  [ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ã¦ã„ã‚‹å ´åˆ](/production/project-configuration#changing-the-convex-folder-name-or-location)ã¯ã€
  ESLint è¨­å®šã‚’æ¬¡ã®ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã™:

  ```ts
  // eslint.config.js
  import { defineConfig } from "eslint/config";

  import convexPlugin from "@convex-dev/eslint-plugin";

  const recommendedConfig = convexPlugin.configs.recommended[0];
  const recommendedRules = recommendedConfig.rules;

  export default defineConfig([
    // ä»–ã®è¨­å®šã‚’ã“ã“ã«è¿½åŠ ...

    // ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å¤‰æ›´ã—ãŸã‚«ã‚¹ã‚¿ãƒ è¨­å®š
    {
      files: ["**/src/convex/**/*.ts"],
      plugins: {
        "@convex-dev": convexPlugin,
      },
      rules: recommendedRules,
    },
  ]);
  ```
</Details>

<Details summary={<>Next.js ã® <code>next lint</code> ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆ</>}>
  `next lint` ã§ `convex` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚‚ ESLint ã‚’å®Ÿè¡Œã™ã‚‹ã«ã¯ã€ãã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’
  ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®å¯¾è±¡ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä¸€è¦§ã«è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚`next.config.ts` ã«
  æ¬¡ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã—ã¾ã™:

  ```ts
  const nextConfig: NextConfig = {
    /* ä»–ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ */

    eslint: {
      dirs: ["pages", "app", "components", "lib", "src", "convex"],
    },
  };
  ```
</Details>

## ãƒ«ãƒ¼ãƒ« \{#rules\}

| ãƒ«ãƒ¼ãƒ«                                                                                                                                    | æ¨å¥¨ | è‡ªå‹•ä¿®æ­£å¯èƒ½ |
| --------------------------------------------------------------------------------------------------------------------------------------- | :--: | :----------: |
| [`@convex-dev/no-old-registered-function-syntax`](#no-old-registered-function-syntax)<br />ç™»éŒ²é–¢æ•°ã«ã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæ§‹æ–‡ã‚’æ¨å¥¨ã™ã‚‹          |  âœ…  |      ğŸ”§      |
| [`@convex-dev/require-argument-validators`](#require-argument-validators)<br />Convex é–¢æ•°ã«å¼•æ•°ãƒãƒªãƒ‡ãƒ¼ã‚¿ã‚’å¿…é ˆã«ã™ã‚‹                     |  âœ…  |      ğŸ”§      |
| [`@convex-dev/explicit-table-ids`](#explicit-table-ids)<br />ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œã§ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’æ˜ç¤ºçš„ã«æŒ‡å®šã™ã‚‹ã“ã¨ã‚’å¿…é ˆã«ã™ã‚‹                |  âœ…  |      ğŸ”§      |
| [`@convex-dev/import-wrong-runtime`](#import-wrong-runtime)<br />Convex ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ç”¨ãƒ•ã‚¡ã‚¤ãƒ«ãŒ Node ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ç”¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ import ã™ã‚‹ã“ã¨ã‚’é˜²ã |      |              |

### no-old-registered-function-syntax \{#no-old-registered-function-syntax\}

ç™»éŒ²ã™ã‚‹é–¢æ•°ã«ã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæ§‹æ–‡ã‚’å„ªå…ˆã—ã¦ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚

Convex ã®ã‚¯ã‚¨ãƒªã€ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯ã€å˜ä¸€ã®é–¢æ•°ã¨ã—ã¦å®šç¾©ã™ã‚‹ã“ã¨ã‚‚ã€
`handler` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æŒã¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦å®šç¾©ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæ§‹æ–‡ã‚’
ä½¿ç”¨ã™ã‚‹ã¨ã€å¼•æ•°ã‚„æˆ»ã‚Šå€¤ã«ãƒãƒªãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ ã§ãã‚‹ãŸã‚ã€å¸¸ã«ã“ã¡ã‚‰ã®æ§‹æ–‡ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒ
æœ›ã¾ã—ã„ã§ã™ã€‚

```ts
// âœ… Allowed by this rule:
export const list = query({
  handler: async (ctx) => {
    const data = await ctx.db.query("messages").collect();
    ...
  },
});

// âŒ ã“ã®ãƒ«ãƒ¼ãƒ«ã§è¨±å¯ã•ã‚Œã¦ã„ã¾ã›ã‚“:
export const list = query(async (ctx) => {
  const data = await ctx.db.query("messages").collect();
  ...
});
```

### require-argument-validators \{#require-argument-validators\}

Convex é–¢æ•°ã§å¼•æ•°ãƒãƒªãƒ‡ãƒ¼ã‚¿ã®æŒ‡å®šã‚’å¿…é ˆã«ã—ã¾ã™ã€‚

Convex ã®ã‚¯ã‚¨ãƒªã€ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯ã€ãƒãƒ³ãƒ‰ãƒ©ãƒ¼é–¢æ•°ã®å®Ÿè¡Œã‚’é–‹å§‹ã™ã‚‹å‰ã«å¼•æ•°ã‚’æ¤œè¨¼ã§ãã¾ã™ã€‚ã“ã‚Œã¯å¼•æ•°ã‚’æ¤œè¨¼ã™ã‚‹ç°¡æ½”ãªæ–¹æ³•ã§ã‚ã‚‹ã ã‘ã§ãªãã€å¼•æ•°ã®å‹ã«å¯¾ã—ã¦å¼•æ•°ãƒãƒªãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚ˆã‚Šè¨˜è¿°çš„ãªé–¢æ•°ä»•æ§˜ã‚’ç”Ÿæˆã§ãã€ãã®çµæœã¨ã—ã¦ OpenAPI ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã‚‚ç”Ÿæˆã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```ts
// âœ… Allowed by this rule:
export const list = query({
  args: {},
  handler: async (ctx) => {
    ...
  },
});

// âœ… Allowed by this rule:
export const list = query({
  args: { channel: v.id('channel') },
  handler: async (ctx, { channel }) => {
    ...
  },
});

// âŒ ã‚ªãƒ—ã‚·ãƒ§ãƒ³ { ignoreUnusedArguments: false } (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ) ã§ã¯è¨±å¯ã•ã‚Œã¦ã„ã¾ã›ã‚“
// âœ… ã‚ªãƒ—ã‚·ãƒ§ãƒ³ { ignoreUnusedArguments: true } ã§ã¯è¨±å¯ã•ã‚Œã¦ã„ã¾ã™
export const list = query({
  handler: async (ctx) => {
    ...
  },
});

// âŒ Not allowed by this rule:
export const list = query({
  handler: async (ctx, { channel }: { channel: Id<"channel"> }) => {
    ...
  },
});
```

ã“ã®ãƒ«ãƒ¼ãƒ«ã¯ã€å¼•æ•°ãƒãƒªãƒ‡ãƒ¼ã‚¿ãƒ¼ã‚’å®šç¾©ã—ã¦ã„ãªã„ã‚‚ã®ã®ã€ãã®å¼•æ•°è‡ªä½“ã‚‚ä½¿ç”¨ã—ã¦ã„ãªã„é–¢æ•°ã‚’è¨±å®¹ã™ã‚‹ã‚ˆã†ã«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã¾ã™ã€‚æ¬¡ã®ã‚ˆã†ã«ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®šã™ã‚‹ã¨ã€ãã®ã‚ˆã†ã«å‹•ä½œã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼š

```ts
// eslint.config.js

export default defineConfig([
  // ãã®ä»–ã®ãƒ«ãƒ¼ãƒ«â€¦

  {
    files: ["**/convex/**/*.ts"],
    rules: {
      "@convex-dev/require-args-validator": [
        "error",
        {
          ignoreUnusedArguments: true,
        },
      ],
    },
  },
]);
```

### explicit-table-ids \{#explicit-table-ids\}

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œã§ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’æ˜ç¤ºçš„ã«æŒ‡å®šã™ã‚‹ã“ã¨ã‚’å¿…é ˆã¨ã—ã¾ã™ã€‚

`convex` npm ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 1.31.0 ä»¥é™ã§ã¯ã€
ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œï¼ˆ`db.get`ã€`db.replace`ã€`db.patch`ã€`db.delete`ï¼‰ã®ç¬¬ 1 å¼•æ•°ã¨ã—ã¦
ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’æ¸¡ã™ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

ã“ã®æ–¹æ³•ã¯ã€ã‚ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ã® ID ãŒåˆ¥ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«å±ã™ã‚‹ã‚‚ã®ã¨ã—ã¦èª¤ã£ã¦å‹ä»˜ã‘ã•ã‚Œã‚‹ã“ã¨ã«ã‚ˆã‚‹
è„†å¼±æ€§ã‚’é˜²ã’ã‚‹ãŸã‚ã€ã‚ˆã‚Šå®‰å…¨ã§ã™ã€‚ID ã‹ã‚‰ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’æ¨è«–ã™ã‚‹æš—é»™çš„ãªæ§‹æ–‡ã¯ã€
é–‹ç™ºè€…ãŒ ID ç”Ÿæˆã‚’ã‚ˆã‚Šç´°ã‹ãåˆ¶å¾¡ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã€å°†æ¥çš„ã«éæ¨å¥¨ã«ãªã‚‹äºˆå®šã§ã™ã€‚
ã“ã® 2 ã¤ã®ç†ç”±ã‹ã‚‰ã€æ–°ã—ã„å½¢å¼ã¸ã®ç§»è¡Œã‚’é–‹ç™ºè€…ã«æ¨å¥¨ã—ã¾ã™ã€‚

ã“ã®ãƒ«ãƒ¼ãƒ«ã¯ã€å¤ã„æš—é»™çš„ãªå½¢å¼ã‹ã‚‰æ–°ã—ã„æ˜ç¤ºçš„ãªå½¢å¼ã¸ã®ã‚³ãƒ¼ãƒ‰ç§»è¡Œã‚’æ”¯æ´ã—ã¾ã™ã€‚
TypeScript ã®å‹æƒ…å ±ã‚’åˆ©ç”¨ã—ã¦ `Id<"tableName">` å‹ã‹ã‚‰ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’è‡ªå‹•çš„ã«æ¨è«–ã—ã€
è‡ªå‹•ä¿®æ­£ã‚’æä¾›ã—ã¾ã™ã€‚

```ts
const messageId: Id<"messages"> = "123" as Id<"messages">;

// âœ… Allowed by this rule:
const message = await ctx.db.get("messages", messageId);
await ctx.db.patch("messages", messageId, { text: "updated" });
await ctx.db.replace("messages", messageId, {
  text: "replaced",
  author: "Alice",
});
await ctx.db.delete("messages", messageId);

// âŒ ã“ã®ãƒ«ãƒ¼ãƒ«ã§ã¯è¨±å¯ã•ã‚Œã¦ã„ã¾ã›ã‚“:
const message = await ctx.db.get(messageId);
await ctx.db.patch(messageId, { text: "updated" });
await ctx.db.replace(messageId, { text: "replaced", author: "Alice" });
await ctx.db.delete(messageId);
```

<Admonition type="info" title="typescript-eslint ãŒå¿…è¦ã§ã™">
  ã“ã®ãƒ«ãƒ¼ãƒ«ã‚’æ©Ÿèƒ½ã•ã›ã‚‹ã«ã¯ã€
  [typescript-eslint](https://typescript-eslint.io) ã‚’ ESLint ã®è¨­å®šã§ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
  typescript-eslint ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšãƒ«ãƒ¼ãƒ«ãŒå‹•ä½œã—ãªã„å ´åˆã¯ã€
  [å‹æƒ…å ±ã‚’åˆ©ç”¨ã—ãŸ lint](https://typescript-eslint.io/troubleshooting/typed-linting/)
  ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚
</Admonition>

ESLint ã‚’ä½¿ç”¨ã—ã¦ã„ãªã„å ´åˆã¯ã€ä»£ã‚ã‚Šã«
`@convex-dev/codemod` CLI ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã£ã¦æ–°ã—ã„ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«è‡ªå‹•çš„ã«ç§»è¡Œã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

```bash
npx @convex-dev/codemod@latest explicit-ids
```

[è©³ã—ãã¯ news.convex.dev ã‚’å‚ç…§ â†’](https://news.convex.dev/db-table-name/)

### import-wrong-runtime \{#import-wrong-runtime\}

Convex ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãƒ•ã‚¡ã‚¤ãƒ«ãŒ Node ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`"use node"` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’å«ã‚€ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã®ã‚’é˜²ãã¾ã™ã€‚

ã“ã®ãƒ«ãƒ¼ãƒ«ã¯è©¦é¨“çš„ãªã‚‚ã®ã§ã™ã€‚æœ‰ç”¨ã§ã‚ã‚Œã°ãœã²ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ãŠå¯„ã›ãã ã•ã„ã€‚

```ts
// `"use node"` ã‚’ä½¿ç”¨ã—ã¦ã„ãªã„ãƒ•ã‚¡ã‚¤ãƒ«å†…:

// âœ… ã“ã®ãƒ«ãƒ¼ãƒ«ã§è¨±å¯ã•ã‚Œã¦ã„ã¾ã™:
import { someFunction } from "./someOtherFile"; // someOtherFile ãŒ `"use node"` ã‚’ä½¿ç”¨ã—ã¦ã„ãªã„å ´åˆ

// âŒ ã“ã®ãƒ«ãƒ¼ãƒ«ã§è¨±å¯ã•ã‚Œã¦ã„ã¾ã›ã‚“:
import { someFunction } from "./someNodeFile"; // someNodeFile ãŒ `"use node"` ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆ
```
