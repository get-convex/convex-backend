---
title: "ローカルデプロイメントによる開発"
slug: "local-deployments"
sidebar_position: 10
sidebar_label: "ローカルデプロイメント"
description: "自分のマシン上でローカル実行されるデプロイメントを使って Convex を開発する"
---

クラウド上にホストされた Convex の dev デプロイメントにコードを同期する代わりに、
自分のコンピューター上で動作しているデプロイメントに接続して開発できます。
ローカルデプロイメントでも Convex ダッシュボードを使用できます。

## Convex におけるデプロイメントの概要 \{#background-on-deployments-in-convex\}

各 Convex デプロイメントは、それぞれ独自のデータ、関数、スケジュールされた関数
などを保持します。1 つのプロジェクトには本番用のデプロイメントが 1 つあり、
チームメンバー 1 人あたり最大 1 つの開発用クラウドデプロイメントに加えて、多数の一時的な
[プレビューデプロイメント](/production/hosting/preview-deployments.mdx) を持つことができます。

自分のマシン上で動作するデプロイメントを使って Convex を開発することもできます。
デプロイメントがローカルで動作しているためコードの同期が高速になり、関数呼び出しや
データベース帯域幅といったリソースは
[Convex プランのクオータ](https://www.convex.dev/pricing) にカウントされません。

既存の Convex プロジェクトとローカルデプロイメントを組み合わせて使用し、
そのプロジェクトの Convex ダッシュボード上でデプロイメントを確認できます。
Convex アカウントがなくてもローカルデプロイメントを利用でき、ローカルで動作する
Convex ダッシュボードを使ってデバッグや状態の確認を行うこともできます。

## ローカルデプロイメントの使用 \{#using-local-deployments\}

<BetaAdmonition feature="Local deployments" verb="are" />

ローカルデプロイメントを利用している間は、ローカルの Convex バックエンドは
`npx convex dev` コマンドの子プロセスとして実行され、このコマンドが停止すると終了します。つまり、このローカルデプロイメントに対して `npx convex run` のような他のコマンドを実行したり、フロントエンドをこのデプロイメントに接続したりするには、`convex dev` コマンドが動いている必要があります。

ローカルバックエンドの状態は `~/.convex/` ディレクトリに保存されます。

### 匿名での開発 \{#anonymous-development\}

ローカルデプロイメントを使うことで、アカウントを作成しなくても Convex を使って開発できます。アプリを本番環境にデプロイしたくなったときや、Convex の機能をさらに活用したくなったときは、`npx convex login` コマンドを実行してローカルデプロイメントを自分のアカウントにリンクできます。

### 既存プロジェクトのローカルデプロイメント \{#local-deployments-for-an-existing-project\}

既存のプロジェクトでローカルデプロイメントを使用するには、次を実行してください:

```sh
npx convex dev --local --once
```

`npx convex dev --configure` を実行すると、常にローカルデプロイメントを選択できるオプションも提示されます。他のフローでは、たとえば、すでにクラウドの開発用デプロイメントを持っているプロジェクトに接続する場合など、一部の状況ではクラウドデプロイメントを利用する想定で処理されることがあります。

## ローカルデプロイメントと本番環境 \{#local-deployments-vs-production\}

ローカルデプロイメントは本番環境での利用には推奨されません。これは開発用の
デプロイメントであり、関数結果のログやエラー応答のスタックトレース全体が
接続中のクライアントに送信されます。

本番アプリケーションを実行するには、Convex クラウド上でホストされる本番
デプロイメントを使用できます。本番環境へのデプロイについての詳細は
[こちら](/production.mdx)を参照してください。

または、[オープンソースの convex-backend リポジトリ](https://github.com/get-convex/convex-backend)
を使用して、本番デプロイメントをセルフホストすることもできます。

### 無効化 \{#disabling\}

プロジェクトでローカル開発環境の利用を停止するには、次のコマンドを実行します:

```sh
npx convex disable-local-deployments
```

クラウドの dev デプロイメントと各ローカルの dev デプロイメントは完全に別個であり、
それぞれ異なるデータを保持しています。デプロイメントを切り替える際には、
同じデータを使い続けられるようにデータを[エクスポートして再インポート](/database/import-export/import-export.mdx)
したくなるかもしれません。

## 制限事項 \{#limitations\}

* **公開 URL なし** - クラウドデプロイメントには Twilio のようなサービスからの
  受信 HTTP リクエストを受け取るための公開 URL がありますが、ローカルデプロイメントは
  自分のコンピュータ上で HTTP リクエストを待ち受けます。同様に、ユーザーのブラウザが
  あなたのコンピュータへの到達方法を知らない限り、Convex の WebSocket 接続で
  ウェブサイトを動かすことはできません。ngrok のようなプロキシを設定するか、
  これらのユースケースではクラウドデプロイメントを使用してください。

* **Node アクションには特定の Node.js バージョンが必要** - Node.js アクション
  (`"use node;"` が記述されたファイルで定義されたアクション) を実行するには、
  プロジェクトが
  [設定されている](/production/project-configuration#configuring-the-nodejs-version)
  のと同じバージョンの Node.js が必要です。現在のデフォルトは Node.js 20 ですが、
  将来的に変更される可能性があります。この問題を解決するには、
  [nvm](https://github.com/nvm-sh/nvm) をインストールしてセットアップし、
  必要なバージョンの Node.js をインストールしてください。プロジェクト全体で
  このバージョンを使用する必要はありません。

* **Node.js アクションはあなたのコンピュータ上で直接実行される** - 通常の
  Node.js サーバーと同様に、Node.js アクションで実行されるコードはファイルシステムに
  無制限にアクセスできます。クエリ、ミューテーション、Convex ランタイムアクションは
  引き続き分離された環境で実行されます。

* `npx convex dev` コマンドを再起動するたびにログは消去されます。

* <a id="safari" /> **Safari でダッシュボードを使用する場合**: Safari は
  [localhost へのリクエストをブロックします](https://bugs.webkit.org/show_bug.cgi?id=171934)。
  そのため、ローカルデプロイメントではダッシュボードが動作しません。
  ローカルデプロイメントを使用する場合は、別のブラウザの使用をお勧めします。

* <a id="brave" /> **Brave でダッシュボードを使用する場合**: Brave は
  [デフォルトで localhost へのリクエストをブロックします](https://brave.com/privacy-updates/27-localhost-permission/)。
  そのため、ローカルデプロイメントではダッシュボードが動作しません。
  次の回避策を使用できます:
  * `brave://flags/` に移動する
  * `#brave-localhost-access-permission` フラグを有効にする
  * Convex ダッシュボードに戻る
  * URL バーで **サイト情報を表示**
    (<img src="/screenshots/brave-site-information.png" alt="サイト情報を表示アイコン" width={24} style={{ verticalAlign: "middle" }} />)
    をクリックし、続いて **サイトの設定** をクリックする
  * **Localhost access** の設定を **Allow** に変更する